{% extends 'base.html.twig' %}
{% block body %}
<div class="bg-lime-900">
    <header>
        {{ include('Includes/Header/index.html.twig') }}
    </header>
</div>

<div class="bg-gray-100 py-8 min-h-screen">
    <div class="container mx-auto px-6">
        <h1 class="text-4xl font-bold text-center text-lime-800 mb-8">Nos produits</h1>

        <div class="mb-8">
            <form method="get" action="{{ path('annonce_index') }}" class="flex flex-col sm:flex-row items-start justify-start space-y-4 sm:space-y-0 sm:space-x-4">
                <div class="w-full sm:w-64">
                    <label for="category" class="block text-sm font-medium text-lime-700 mb-2">Filtrer par catégorie :</label>
                    <div class="relative">
                        <select name="category" id="category" onchange="this.form.submit()" class="block appearance-none w-full pl-3 pr-10 py-2 text-base border-2 border-lime-300 focus:outline-none focus:ring-2 focus:ring-lime-500 focus:border-lime-500 sm:text-sm rounded-full bg-white text-lime-800">
                            <option>Toutes les catégories</option>
                            {% for category in categories %}
                                <option value="{{ category.id }}" {% if category.id == selectedCategory %}selected{% endif %}>
                                    {{ category.nom|capitalize }}
                                </option>
                            {% endfor %}
                        </select>
                        <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-lime-700">
                            <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                            </svg>
                        </div>
                    </div>
                </div>
            </form>
        </div>

        {% if pure_annonces is empty %}
            <div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-lg" role="alert">
                <p class="font-bold">Aucun produit n'est disponible.</p>
                <p>Essayez de modifier vos critères de recherche.</p>
            </div>
        {% else %}
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                {% for pure_annonce in pure_annonces %}
                    <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-xl transition-shadow duration-300">
                        <div class="relative mb-4">
                            <a href="{{ path('annonce_show', {'slug': pure_annonce.slug}) }}" class="block">
                                <img src="{{ '/uploads/images/' ~ pure_annonce.image }}" alt="{{ pure_annonce.nom }}" class="w-full h-48 object-cover rounded-t-lg">
                                <div class="absolute bottom-2 right-2 bg-lime-600 text-white text-xs px-2 py-1 rounded">Nouveau</div>
                            </a>
                        </div>
                        <div class="px-4 py-2">
                            <a href="{{ path('annonce_show', {'slug': pure_annonce.slug}) }}" class="block">
                                <h2 class="text-xl font-semibold text-lime-900 mb-2">{{ pure_annonce.nom }}</h2>
                            </a>
                            <p class="text-gray-600 text-sm mb-4">{{ pure_annonce.description|slice(0, 100) }}...</p>
                            <p class="text-gray-500 text-xs">{{ pure_annonce.dateCreation ? pure_annonce.dateCreation|date('d-m-Y') : '' }}</p>
                            <div class="mt-4 flex justify-between items-center">
                                <a href="{{ path('annonce_show', {'slug': pure_annonce.slug}) }}" class="bg-lime-600 text-white text-sm py-2 px-4 rounded hover:bg-lime-700 transition-colors duration-300">Voir Détails</a>
                                <span class="text-lime-900 font-semibold">{{ pure_annonce.prix }} €</span>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    </div>
</div>

<div class="bg-lime-900">
    <footer>
        {{ include('Includes/Footer/index.html.twig') }}
    </footer>

    {{ include('Includes/Menu-flottant/index.html.twig') }}
</div>
{% endblock %}

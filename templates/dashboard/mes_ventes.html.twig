{% extends 'dashboard/vendeur.html.twig' %}

{% block content %}
    <h1 class="text-3xl font-bold mb-6 text-yellow-400">Mes ventes</h1>

    <div id="ventes-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for vente in ventes %}
            <div class="vente-card bg-gray-800 rounded-lg shadow-lg overflow-hidden transition-all duration-300 ease-in-out hover:shadow-2xl transform hover:-translate-y-1" id="vente-{{ vente.id }}" data-statut-id="{{ vente.statut.id }}">
                <div class="p-5 border-l-4" data-border>
                    <h2 class="text-xl font-semibold text-yellow-400 mb-3">Commande #{{ vente.id }}</h2>
                    <p class="text-gray-300 mb-2"><span class="font-medium text-gray-400">Date :</span> {{ vente.dateCommande|date('d-m-Y H:i') }}</p>
                    <p class="text-gray-300 mb-2"><span class="font-medium text-gray-400">Acheteur :</span> {{ vente.pureUser.nom }} {{ vente.pureUser.prenom }}</p>
                    <p class="text-gray-300 mb-2"><span class="font-medium text-gray-400">Annonce :</span> {{ vente.pureAnnonce.nom }}</p>
                    <p class="text-gray-300 mb-2"><span class="font-medium text-gray-400">Quantité :</span> {{ vente.quantite }}</p>
                    <p class="text-gray-300 mb-4">
                        <span class="font-medium text-gray-400">Statut actuel :</span> 
                        <span class="current-status px-3 py-1 rounded-full text-sm font-semibold ml-2" data-status-badge>
                            {{ vente.statut.intitule }}
                        </span>
                    </p>
                    {{ form_start(forms[vente.id], {'attr': {'class': 'update-status-form'}}) }}
                        {{ form_widget(forms[vente.id].statut, {'attr': {'class': 'w-full p-2 mb-3 bg-gray-700 text-white rounded-md border border-gray-600 focus:border-yellow-500 focus:ring focus:ring-yellow-500 focus:ring-opacity-50'}}) }}
                        <button type="submit" class="w-full bg-yellow-500 hover:bg-yellow-600 text-gray-900 font-bold py-2 px-4 rounded-md transition duration-300 ease-in-out transform hover:scale-105">
                            Changer le statut
                        </button>
                    {{ form_end(forms[vente.id]) }}
                </div>
            </div>
        {% else %}
            <p class="text-gray-400 col-span-full text-center text-lg">Aucune vente trouvée.</p>
        {% endfor %}
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('../assets/js/ventes.js') }}"></script>
{% endblock %}
